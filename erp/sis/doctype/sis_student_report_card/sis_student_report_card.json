{
 "doctype": "DocType",
 "name": "SIS Student Report Card",
 "module": "SIS",
 "istable": 0,
 "engine": "InnoDB",
 "field_order": [
  "title",
  "template_id",
  "form_id",
  "class_id",
  "student_id",
  "school_year",
  "semester_part",
  "status",
  "campus_id",
  "data_json",
  "approval_section",
  "approval_status",
  "is_approved",
  "approved_by",
  "approved_at",
  "approval_history",
  "pdf_file",
  "subject_approval_tracking_section",
  "homeroom_l2_approved",
  "all_sections_l2_approved",
  "column_break_subject_tracking_1",
  "scores_submitted_count",
  "scores_l2_approved_count",
  "scores_total_count",
  "column_break_subject_tracking_2",
  "subject_eval_submitted_count",
  "subject_eval_l2_approved_count",
  "subject_eval_total_count",
  "column_break_subject_tracking_3",
  "intl_submitted_count",
  "intl_l2_approved_count",
  "intl_total_count",
  "section_approval_section",
  "homeroom_approval_status",
  "homeroom_submitted_at",
  "homeroom_submitted_by",
  "homeroom_level_1_approved_at",
  "homeroom_level_1_approved_by",
  "homeroom_level_2_approved_at",
  "homeroom_level_2_approved_by",
  "homeroom_rejected_at",
  "homeroom_rejected_by",
  "homeroom_rejection_reason",
  "column_break_section_scores",
  "scores_approval_status",
  "scores_submitted_at",
  "scores_submitted_by",
  "scores_level_1_approved_at",
  "scores_level_1_approved_by",
  "scores_level_2_approved_at",
  "scores_level_2_approved_by",
  "scores_rejected_at",
  "scores_rejected_by",
  "scores_rejection_reason",
  "approval_tracking_section",
  "submitted_at",
  "submitted_by",
  "column_break_approval_1",
  "level_1_approved_at",
  "level_1_approved_by",
  "column_break_approval_2",
  "level_2_approved_at",
  "level_2_approved_by",
  "column_break_approval_3",
  "reviewed_at",
  "reviewed_by",
  "rejection_section",
  "rejected_at",
  "rejected_by",
  "rejection_reason",
  "rejected_from_level",
  "rejected_section"
 ],
 "fields": [
  {"fieldname": "title", "fieldtype": "Data", "label": "Tiêu đề", "in_list_view": 1},
  {"fieldname": "template_id", "fieldtype": "Link", "label": "Template", "options": "SIS Report Card Template", "reqd": 1, "in_list_view": 1},
  {"fieldname": "form_id", "fieldtype": "Link", "label": "Form", "options": "SIS Report Card Form", "reqd": 1},
  {"fieldname": "class_id", "fieldtype": "Link", "label": "Lớp", "options": "SIS Class", "reqd": 1, "in_list_view": 1},
  {"fieldname": "student_id", "fieldtype": "Link", "label": "Học sinh", "options": "CRM Student", "reqd": 1, "in_list_view": 1},
  {"fieldname": "school_year", "fieldtype": "Link", "label": "Năm học", "options": "SIS School Year", "reqd": 1},
  {"fieldname": "semester_part", "fieldtype": "Select", "label": "Kì", "options": "Mid Term 1\nEnd Term 1\nMid Term 2\nEnd Term 2", "reqd": 1},
  {"fieldname": "status", "fieldtype": "Select", "label": "Trạng thái", "options": "draft\nlocked\npublished", "default": "draft", "in_list_view": 1},          
  {"fieldname": "campus_id", "fieldtype": "Link", "label": "Trường học", "options": "SIS Campus", "reqd": 1},                                                   
  {"fieldname": "data_json", "fieldtype": "Long Text", "label": "Dữ liệu báo cáo"},
  {"fieldname": "approval_section", "fieldtype": "Section Break", "label": "Phê duyệt chung"},
  {"fieldname": "approval_status", "fieldtype": "Select", "label": "Trạng thái phê duyệt", "options": "draft\nentry\nsubmitted\nlevel_1_approved\nlevel_2_approved\nreviewed\npublished\nrejected", "default": "draft", "in_list_view": 1, "in_standard_filter": 1},
  {"fieldname": "is_approved", "fieldtype": "Check", "label": "Đã phê duyệt", "default": 0, "in_list_view": 1},
  {"fieldname": "approved_by", "fieldtype": "Link", "label": "Người phê duyệt cuối", "options": "User", "read_only": 1},
  {"fieldname": "approved_at", "fieldtype": "Datetime", "label": "Thời gian phê duyệt cuối", "read_only": 1},
  {"fieldname": "approval_history", "fieldtype": "Long Text", "label": "Lịch sử phê duyệt (JSON)"},
  {"fieldname": "pdf_file", "fieldtype": "Data", "label": "File PDF", "read_only": 1},
  {"fieldname": "subject_approval_tracking_section", "fieldtype": "Section Break", "label": "Theo dõi duyệt theo môn", "collapsible": 1},
  {"fieldname": "homeroom_l2_approved", "fieldtype": "Check", "label": "Homeroom đã L2 approved", "default": 0, "read_only": 1},
  {"fieldname": "all_sections_l2_approved", "fieldtype": "Check", "label": "Tất cả sections đã L2 approved", "default": 0, "read_only": 1, "description": "Flag computed: Tất cả phần cần duyệt đã được duyệt L2"},
  {"fieldname": "column_break_subject_tracking_1", "fieldtype": "Column Break"},
  {"fieldname": "scores_submitted_count", "fieldtype": "Int", "label": "Số môn Scores đã submit", "default": 0, "read_only": 1},
  {"fieldname": "scores_l2_approved_count", "fieldtype": "Int", "label": "Số môn Scores đã L2 approved", "default": 0, "read_only": 1},
  {"fieldname": "scores_total_count", "fieldtype": "Int", "label": "Tổng số môn Scores", "default": 0, "read_only": 1},
  {"fieldname": "column_break_subject_tracking_2", "fieldtype": "Column Break"},
  {"fieldname": "subject_eval_submitted_count", "fieldtype": "Int", "label": "Số môn Eval đã submit", "default": 0, "read_only": 1},
  {"fieldname": "subject_eval_l2_approved_count", "fieldtype": "Int", "label": "Số môn Eval đã L2 approved", "default": 0, "read_only": 1},
  {"fieldname": "subject_eval_total_count", "fieldtype": "Int", "label": "Tổng số môn Eval", "default": 0, "read_only": 1},
  {"fieldname": "column_break_subject_tracking_3", "fieldtype": "Column Break"},
  {"fieldname": "intl_submitted_count", "fieldtype": "Int", "label": "Số phần INTL đã submit", "default": 0, "read_only": 1},
  {"fieldname": "intl_l2_approved_count", "fieldtype": "Int", "label": "Số phần INTL đã L2 approved", "default": 0, "read_only": 1},
  {"fieldname": "intl_total_count", "fieldtype": "Int", "label": "Tổng số phần INTL", "default": 0, "read_only": 1},
  {"fieldname": "section_approval_section", "fieldtype": "Section Break", "label": "Phê duyệt theo Section", "collapsible": 1},
  {"fieldname": "homeroom_approval_status", "fieldtype": "Select", "label": "Trạng thái Homeroom", "options": "draft\nentry\nsubmitted\nlevel_1_approved\nlevel_2_approved\nrejected", "default": "draft", "in_standard_filter": 1},
  {"fieldname": "homeroom_submitted_at", "fieldtype": "Datetime", "label": "Homeroom Submit lúc", "read_only": 1},
  {"fieldname": "homeroom_submitted_by", "fieldtype": "Link", "label": "Homeroom Submit bởi", "options": "User", "read_only": 1},
  {"fieldname": "homeroom_level_1_approved_at", "fieldtype": "Datetime", "label": "Homeroom L1 duyệt lúc", "read_only": 1},
  {"fieldname": "homeroom_level_1_approved_by", "fieldtype": "Link", "label": "Homeroom L1 duyệt bởi", "options": "User", "read_only": 1},
  {"fieldname": "homeroom_level_2_approved_at", "fieldtype": "Datetime", "label": "Homeroom L2 duyệt lúc", "read_only": 1},
  {"fieldname": "homeroom_level_2_approved_by", "fieldtype": "Link", "label": "Homeroom L2 duyệt bởi", "options": "User", "read_only": 1},
  {"fieldname": "homeroom_rejected_at", "fieldtype": "Datetime", "label": "Homeroom trả về lúc", "read_only": 1},
  {"fieldname": "homeroom_rejected_by", "fieldtype": "Link", "label": "Homeroom trả về bởi", "options": "User", "read_only": 1},
  {"fieldname": "homeroom_rejection_reason", "fieldtype": "Small Text", "label": "Homeroom lý do trả về", "read_only": 1},
  {"fieldname": "column_break_section_scores", "fieldtype": "Column Break"},
  {"fieldname": "scores_approval_status", "fieldtype": "Select", "label": "Trạng thái Scores/Subject", "options": "draft\nentry\nsubmitted\nlevel_1_approved\nlevel_2_approved\nrejected", "default": "draft", "in_standard_filter": 1},
  {"fieldname": "scores_submitted_at", "fieldtype": "Datetime", "label": "Scores Submit lúc", "read_only": 1},
  {"fieldname": "scores_submitted_by", "fieldtype": "Link", "label": "Scores Submit bởi", "options": "User", "read_only": 1},
  {"fieldname": "scores_level_1_approved_at", "fieldtype": "Datetime", "label": "Scores L1 duyệt lúc", "read_only": 1},
  {"fieldname": "scores_level_1_approved_by", "fieldtype": "Link", "label": "Scores L1 duyệt bởi", "options": "User", "read_only": 1},
  {"fieldname": "scores_level_2_approved_at", "fieldtype": "Datetime", "label": "Scores L2 duyệt lúc", "read_only": 1},
  {"fieldname": "scores_level_2_approved_by", "fieldtype": "Link", "label": "Scores L2 duyệt bởi", "options": "User", "read_only": 1},
  {"fieldname": "scores_rejected_at", "fieldtype": "Datetime", "label": "Scores trả về lúc", "read_only": 1},
  {"fieldname": "scores_rejected_by", "fieldtype": "Link", "label": "Scores trả về bởi", "options": "User", "read_only": 1},
  {"fieldname": "scores_rejection_reason", "fieldtype": "Small Text", "label": "Scores lý do trả về", "read_only": 1},
  {"fieldname": "approval_tracking_section", "fieldtype": "Section Break", "label": "Chi tiết phê duyệt chung (L3, L4)", "collapsible": 1},
  {"fieldname": "submitted_at", "fieldtype": "Datetime", "label": "Thời gian Submit (chung)", "read_only": 1},
  {"fieldname": "submitted_by", "fieldtype": "Link", "label": "Người Submit (chung)", "options": "User", "read_only": 1},
  {"fieldname": "column_break_approval_1", "fieldtype": "Column Break"},
  {"fieldname": "level_1_approved_at", "fieldtype": "Datetime", "label": "Thời gian duyệt L1 (chung)", "read_only": 1},
  {"fieldname": "level_1_approved_by", "fieldtype": "Link", "label": "Người duyệt L1 (chung)", "options": "User", "read_only": 1},
  {"fieldname": "column_break_approval_2", "fieldtype": "Column Break"},
  {"fieldname": "level_2_approved_at", "fieldtype": "Datetime", "label": "Thời gian duyệt L2 (chung)", "read_only": 1},
  {"fieldname": "level_2_approved_by", "fieldtype": "Link", "label": "Người duyệt L2 (chung)", "options": "User", "read_only": 1},
  {"fieldname": "column_break_approval_3", "fieldtype": "Column Break"},
  {"fieldname": "reviewed_at", "fieldtype": "Datetime", "label": "Thời gian Review L3", "read_only": 1},
  {"fieldname": "reviewed_by", "fieldtype": "Link", "label": "Người Review L3", "options": "User", "read_only": 1},
  {"fieldname": "rejection_section", "fieldtype": "Section Break", "label": "Thông tin trả về (chung)", "collapsible": 1},
  {"fieldname": "rejected_at", "fieldtype": "Datetime", "label": "Thời gian trả về", "read_only": 1},
  {"fieldname": "rejected_by", "fieldtype": "Link", "label": "Người trả về", "options": "User", "read_only": 1},
  {"fieldname": "rejection_reason", "fieldtype": "Small Text", "label": "Lý do trả về", "read_only": 1},
  {"fieldname": "rejected_from_level", "fieldtype": "Int", "label": "Trả về từ Level", "read_only": 1, "description": "Level mà báo cáo bị reject (3 hoặc 4)"},
  {"fieldname": "rejected_section", "fieldtype": "Select", "label": "Section bị trả về", "options": "\nhomeroom\nscores\nboth", "read_only": 1, "description": "Section nào bị reject: homeroom (GVCN), scores (GVBM), hoặc both (cả hai)"}
 ],
 "permissions": [
  {"role": "System Manager", "read": 1, "write": 1, "create": 1, "delete": 1, "print": 1, "email": 1, "export": 1, "report": 1, "share": 1},
  {"role": "SIS Admin", "read": 1, "write": 1, "create": 1, "delete": 1, "print": 1, "email": 1, "export": 1, "report": 1, "share": 1},
  {"role": "SIS Manager", "read": 1, "write": 1, "create": 1, "delete": 1, "print": 1, "email": 1, "export": 1, "report": 1, "share": 1},
  {"role": "SIS Teacher", "read": 1, "write": 1}
 ],
 "title_field": "title",
 "sort_field": "modified",
 "sort_order": "DESC"
}
